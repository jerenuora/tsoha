{% extends "layout.html" %}

<html>
  {% block content %}

  <body>
    <p>Viestejä: </p>
    <div class="messagetable">
        {% for message in messages %}

        <div class="messageheader">
            <div >{{message.writer}}</div>
            <div >{{message.date}}</div>
            {% if session.username and session.username == message.writer %}

        </div>
        <div class="messagearea">
            <div class="messagetext">

            {{message.message}}
            </div>
        </div>
        <div class="deleteedit">
            <div>
                <form  action="/editpage/{{message.id}}" method="GET">
                    <input type="submit" value="Muokkaa">
                    <input type="hidden" name="dest" value="message" />
                </form>

            {%if messages|length > 1 %}
            </form>
        </div>

            <div>
                <form  action="/delete/{{message.id}}" method="POST">

                    <input type="submit" value="Poista">
                    <input type="hidden" name="csrf_token" value="{{ session.csrf_token }}">
                    <input type="hidden" name="dest" value="message" />
                </form>
                {%endif%}
                    {%endif%}
            </div>
        </div>

        {%endfor%}
    </div>

{% if session.username %}

<div class="form">
    <form  action="/postmessage/{{thread_id}}" method="POST">
        Kirjoita viesti:
        <br>
        <textarea class="textarea" type="text" name="message"></textarea>
        <input type="submit" value="Lähetä">
        <input type="hidden" name="csrf_token" value="{{ session.csrf_token }}">
    </form>
</div>
{%endif%}
  </body>
  {% endblock %}
</html>
